<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/" text="Atras" icon="arrow-back-outline" [routerLink]="['/home']"></ion-back-button>
    </ion-buttons>
    <ion-title>Carro de Compras</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ng-container *ngIf="mostrarSinStock; else disponiblesPage">
    <h3 style="color: white; text-align: center;">Productos sin stock o no disponibles</h3>
    <ion-card class="producto-card" *ngFor="let producto of productosSinStock">
      <ion-item lines="none">
        <ion-thumbnail slot="start">
          <img [src]="producto.imagen" [alt]="producto.nombre" />
        </ion-thumbnail>
        <ion-label>
          <h3 class="titulo-producto">{{ producto.nombre }}</h3>
          <p class="precio"><strong>${{ producto.precio }}</strong></p>
          <p style="color: red; font-weight: bold;">Sin stock / No disponible</p>
        </ion-label>
      </ion-item>
    </ion-card>

    <ion-button expand="block" color="primary" (click)="eliminarProductosSinStock()">
      Eliminar Productos sin Stock / No disponibles
    </ion-button>
  </ng-container>

  <ng-template #disponiblesPage>
    <h3 style="color: white; text-align: center;">Productos disponibles</h3>
    <ion-card class="producto-card" *ngFor="let producto of productosDisponibles">
      <ion-item lines="none">
        <ion-thumbnail slot="start">
          <img [src]="producto.imagen" [alt]="producto.nombre" />
        </ion-thumbnail>
        <ion-label>
          <h3 class="titulo-producto">{{ producto.nombre }}</h3>
          <p class="precio"><strong>${{ producto.precio }}</strong></p>
        </ion-label>
      </ion-item>

      <ion-row class="botones-cantidad" align-items-center>
        <ion-col size="auto">
          <ion-button fill="clear" color="success" (click)="incrementarCantidad(producto)">
            <ion-icon name="add-circle-outline"></ion-icon>
          </ion-button>
        </ion-col>

        <ion-col size="auto">
          <ion-input type="number" [(ngModel)]="producto.cantidad" min="0" class="input-cantidad"></ion-input>
        </ion-col>

        <ion-col size="auto">
          <ion-button fill="clear" color="danger" (click)="decrementarCantidad(producto)">
            <ion-icon name="remove-circle-outline"></ion-icon>
          </ion-button>
        </ion-col>
      </ion-row>
    </ion-card>

    <div class="total-container">
      <p>Total:</p>
      <p class="total-precio">${{ calcularTotal() }}</p>
    </div>

    <div class="boton-comprar-container">
      <ion-button class="btncompra" color="primary" (click)="alertascarro()">
        <ion-icon slot="start" name="cart-outline"></ion-icon>
        Comprar
      </ion-button>
    </div>
  </ng-template>
</ion-content>
